/*-----------------CADASTRO POR MES------------------*/

SELECT * FROM ( 
SELECT 
A.A3_COD,
A.A3_NOME,
MONTH(B.A1_DTCAD) AS DT_CAD,
COUNT(*) AS QTD
FROM SA3010 A
LEFT JOIN SA1010 B ON B.D_E_L_E_T_ = '' AND A.A3_COD = B.A1_VEND
WHERE A.D_E_L_E_T_ = ''
AND A.A3_COD IN('000030', '000060','000069', '000091')
AND YEAR(B.A1_DTCAD) = 2020
AND MONTH(B.A1_DTCAD) IN (01, 02, 03) 
GROUP BY A.A3_COD, A.A3_NOME, B.A1_DTCAD
) EM_LINHA
PIVOT (SUM(QTD) FOR DT_CAD IN ( [1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12])) EM_COLUNAS	
ORDER BY 1


/*----------------CADASTRO POR VENDEDORES ROGERIO-------------------*/


SELECT 
B.A1_COD AS COD_CLIENTE,
B.A1_NOME AS CLIENTE,
CONVERT(VARCHAR,CAST(B.A1_DTCAD AS DATETIME),103) AS DT_CAD
FROM SA3010 A
LEFT JOIN SA1010 B ON A.A3_COD = B.A1_VEND AND B.D_E_L_E_T_ = ''
WHERE A.D_E_L_E_T_ = ''
AND A.A3_COD IN('000030')
AND YEAR(B.A1_DTCAD) = 2020
AND MONTH(B.A1_DTCAD) IN (01, 02, 03) 


/*----------------CADASTRO POR VENDEDORES REGIANE-------------------*/

SELECT 
B.A1_COD AS COD_CLIENTE,
B.A1_NOME AS CLIENTE,
CONVERT(VARCHAR,CAST(B.A1_DTCAD AS DATETIME),103) AS DT_CAD
FROM SA3010 A
LEFT JOIN SA1010 B ON A.A3_COD = B.A1_VEND AND B.D_E_L_E_T_ = ''
WHERE A.D_E_L_E_T_ = ''
AND A.A3_COD IN('000060')
AND YEAR(B.A1_DTCAD) = 2020
AND MONTH(B.A1_DTCAD) IN (01, 02, 03) 


/*----------------CADASTRO POR VENDEDORES RICARDO BARBOSA-------------------*/

SELECT 
B.A1_COD AS COD_CLIENTE,
B.A1_NOME AS CLIENTE,
CONVERT(VARCHAR,CAST(B.A1_DTCAD AS DATETIME),103) AS DT_CAD
FROM SA3010 A
LEFT JOIN SA1010 B ON A.A3_COD = B.A1_VEND AND B.D_E_L_E_T_ = ''
WHERE A.D_E_L_E_T_ = ''
AND A.A3_COD IN('000091')
AND YEAR(B.A1_DTCAD) = 2020
AND MONTH(B.A1_DTCAD) IN (01, 02, 03) 

/*------------------------------------------------------------------------*/


SELECT * FROM SA3010 WHERE A3_COD IN('000030','000060', '000091', '000069')

