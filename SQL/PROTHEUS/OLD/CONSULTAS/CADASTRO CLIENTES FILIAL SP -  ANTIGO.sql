
SELECT 
A.A1_VEND, 
B.A3_NOME,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000030') AND MONTH(A.A1_DTCAD) = 1 AND YEAR(A.A1_DTCAD) = 2020), 0) AS JAN,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000030') AND MONTH(A.A1_DTCAD) = 2 AND YEAR(A.A1_DTCAD) = 2020), 0) AS FEV,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000030') AND MONTH(A.A1_DTCAD) = 3 AND YEAR(A.A1_DTCAD) = 2020), 0) AS MAR,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000030') AND MONTH(A.A1_DTCAD) = 4 AND YEAR(A.A1_DTCAD) = 2020), 0) AS ABR,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000030') AND MONTH(A.A1_DTCAD) = 5 AND YEAR(A.A1_DTCAD) = 2020), 0) AS MAI,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000030') AND MONTH(A.A1_DTCAD) = 6 AND YEAR(A.A1_DTCAD) = 2020), 0) AS JUN,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000030') AND MONTH(A.A1_DTCAD) = 7 AND YEAR(A.A1_DTCAD) = 2020), 0) AS JUL,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000030') AND MONTH(A.A1_DTCAD) = 8 AND YEAR(A.A1_DTCAD) = 2020), 0) AS AGO,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000030') AND MONTH(A.A1_DTCAD) = 9 AND YEAR(A.A1_DTCAD) = 2020), 0) AS S_E_T,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000030') AND MONTH(A.A1_DTCAD) = 10 AND YEAR(A.A1_DTCAD) = 2020), 0) AS O_U_T,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000030') AND MONTH(A.A1_DTCAD) = 11 AND YEAR(A.A1_DTCAD) = 2020), 0) AS NOV,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000030') AND MONTH(A.A1_DTCAD) = 12 AND YEAR(A.A1_DTCAD) = 2020), 0) AS DEZ,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000030') AND MONTH(A.A1_DTCAD) = 1 AND YEAR(A.A1_DTCAD) = 2020), 0)  +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000030') AND MONTH(A.A1_DTCAD) = 2 AND YEAR(A.A1_DTCAD) = 2020), 0)  +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000030') AND MONTH(A.A1_DTCAD) = 3 AND YEAR(A.A1_DTCAD) = 2020), 0)  +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000030') AND MONTH(A.A1_DTCAD) = 4 AND YEAR(A.A1_DTCAD) = 2020), 0)  +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000030') AND MONTH(A.A1_DTCAD) = 5 AND YEAR(A.A1_DTCAD) = 2020), 0)  +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000030') AND MONTH(A.A1_DTCAD) = 6 AND YEAR(A.A1_DTCAD) = 2020), 0)  +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000030') AND MONTH(A.A1_DTCAD) = 7 AND YEAR(A.A1_DTCAD) = 2020), 0)  +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000030') AND MONTH(A.A1_DTCAD) = 8 AND YEAR(A.A1_DTCAD) = 2020), 0)  +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000030') AND MONTH(A.A1_DTCAD) = 9 AND YEAR(A.A1_DTCAD) = 2020), 0)  +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000030') AND MONTH(A.A1_DTCAD) = 10 AND YEAR(A.A1_DTCAD) = 2020), 0) +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000030') AND MONTH(A.A1_DTCAD) = 11 AND YEAR(A.A1_DTCAD) = 2020), 0) +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000030') AND MONTH(A.A1_DTCAD) = 12 AND YEAR(A.A1_DTCAD) = 2020), 0) AS TOTAL
FROM SA1010 A, SA3010 B
WHERE A.D_E_L_E_T_ = ''
AND A.A1_VEND = B.A3_COD
AND A.A1_VEND IN('000030')
AND A.A1_DTCAD BETWEEN '20200101' AND '20200131'
GROUP BY A.A1_VEND,  MONTH(A.A1_DTCAD) , YEAR(A.A1_DTCAD), B.A3_NOME
/*-----------------------------------------------------------------------*/

SELECT 
A.A1_VEND, 
B.A3_NOME,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000060') AND MONTH(A.A1_DTCAD) = 1 AND YEAR(A.A1_DTCAD) = 2020), 0) AS JAN,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000060') AND MONTH(A.A1_DTCAD) = 2 AND YEAR(A.A1_DTCAD) = 2020), 0) AS FEV,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000060') AND MONTH(A.A1_DTCAD) = 3 AND YEAR(A.A1_DTCAD) = 2020), 0) AS MAR,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000060') AND MONTH(A.A1_DTCAD) = 4 AND YEAR(A.A1_DTCAD) = 2020), 0) AS ABR,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000060') AND MONTH(A.A1_DTCAD) = 5 AND YEAR(A.A1_DTCAD) = 2020), 0) AS MAI,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000060') AND MONTH(A.A1_DTCAD) = 6 AND YEAR(A.A1_DTCAD) = 2020), 0) AS JUN,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000060') AND MONTH(A.A1_DTCAD) = 7 AND YEAR(A.A1_DTCAD) = 2020), 0) AS JUL,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000060') AND MONTH(A.A1_DTCAD) = 8 AND YEAR(A.A1_DTCAD) = 2020), 0) AS AGO,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000060') AND MONTH(A.A1_DTCAD) = 9 AND YEAR(A.A1_DTCAD) = 2020), 0) AS S_E_T,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000060') AND MONTH(A.A1_DTCAD) = 10 AND YEAR(A.A1_DTCAD) = 2020), 0) AS O_U_T,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000060') AND MONTH(A.A1_DTCAD) = 11 AND YEAR(A.A1_DTCAD) = 2020), 0) AS NOV,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000060') AND MONTH(A.A1_DTCAD) = 12 AND YEAR(A.A1_DTCAD) = 2020), 0) AS DEZ,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000060') AND MONTH(A.A1_DTCAD) = 1 AND YEAR(A.A1_DTCAD) = 2020), 0)  +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000060') AND MONTH(A.A1_DTCAD) = 2 AND YEAR(A.A1_DTCAD) = 2020), 0)  +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000060') AND MONTH(A.A1_DTCAD) = 3 AND YEAR(A.A1_DTCAD) = 2020), 0)  +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000060') AND MONTH(A.A1_DTCAD) = 4 AND YEAR(A.A1_DTCAD) = 2020), 0)  +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000060') AND MONTH(A.A1_DTCAD) = 5 AND YEAR(A.A1_DTCAD) = 2020), 0)  +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000060') AND MONTH(A.A1_DTCAD) = 6 AND YEAR(A.A1_DTCAD) = 2020), 0)  +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000060') AND MONTH(A.A1_DTCAD) = 7 AND YEAR(A.A1_DTCAD) = 2020), 0)  +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000060') AND MONTH(A.A1_DTCAD) = 8 AND YEAR(A.A1_DTCAD) = 2020), 0)  +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000060') AND MONTH(A.A1_DTCAD) = 9 AND YEAR(A.A1_DTCAD) = 2020), 0)  +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000060') AND MONTH(A.A1_DTCAD) = 10 AND YEAR(A.A1_DTCAD) = 2020), 0) +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000060') AND MONTH(A.A1_DTCAD) = 11 AND YEAR(A.A1_DTCAD) = 2020), 0) +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000060') AND MONTH(A.A1_DTCAD) = 12 AND YEAR(A.A1_DTCAD) = 2020), 0) AS TOTAL
FROM SA1010 A, SA3010 B
WHERE A.D_E_L_E_T_ = ''
AND A.A1_VEND = B.A3_COD
AND A.A1_VEND IN('000060')
AND A.A1_DTCAD BETWEEN '20200101' AND '20200131'
GROUP BY A.A1_VEND,  MONTH(A.A1_DTCAD) , YEAR(A.A1_DTCAD), B.A3_NOME

/*----------------------------------------------------------------------------------*/

SELECT 
A.A1_VEND, 
B.A3_NOME,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000091') AND MONTH(A.A1_DTCAD) = 1 AND YEAR(A.A1_DTCAD) = 2020), 0) AS JAN,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000091') AND MONTH(A.A1_DTCAD) = 2 AND YEAR(A.A1_DTCAD) = 2020), 0) AS FEV,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000091') AND MONTH(A.A1_DTCAD) = 3 AND YEAR(A.A1_DTCAD) = 2020), 0) AS MAR,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000091') AND MONTH(A.A1_DTCAD) = 4 AND YEAR(A.A1_DTCAD) = 2020), 0) AS ABR,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000091') AND MONTH(A.A1_DTCAD) = 5 AND YEAR(A.A1_DTCAD) = 2020), 0) AS MAI,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000091') AND MONTH(A.A1_DTCAD) = 6 AND YEAR(A.A1_DTCAD) = 2020), 0) AS JUN,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000091') AND MONTH(A.A1_DTCAD) = 7 AND YEAR(A.A1_DTCAD) = 2020), 0) AS JUL,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000091') AND MONTH(A.A1_DTCAD) = 8 AND YEAR(A.A1_DTCAD) = 2020), 0) AS AGO,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000091') AND MONTH(A.A1_DTCAD) = 9 AND YEAR(A.A1_DTCAD) = 2020), 0) AS S_E_T,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000091') AND MONTH(A.A1_DTCAD) = 10 AND YEAR(A.A1_DTCAD) = 2020), 0) AS O_U_T,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000091') AND MONTH(A.A1_DTCAD) = 11 AND YEAR(A.A1_DTCAD) = 2020), 0) AS NOV,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000091') AND MONTH(A.A1_DTCAD) = 12 AND YEAR(A.A1_DTCAD) = 2020), 0) AS DEZ,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000091') AND MONTH(A.A1_DTCAD) = 1 AND YEAR(A.A1_DTCAD) = 2020), 0)  +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000091') AND MONTH(A.A1_DTCAD) = 2 AND YEAR(A.A1_DTCAD) = 2020), 0)  +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000091') AND MONTH(A.A1_DTCAD) = 3 AND YEAR(A.A1_DTCAD) = 2020), 0)  +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000091') AND MONTH(A.A1_DTCAD) = 4 AND YEAR(A.A1_DTCAD) = 2020), 0)  +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000091') AND MONTH(A.A1_DTCAD) = 5 AND YEAR(A.A1_DTCAD) = 2020), 0)  +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000091') AND MONTH(A.A1_DTCAD) = 6 AND YEAR(A.A1_DTCAD) = 2020), 0)  +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000091') AND MONTH(A.A1_DTCAD) = 7 AND YEAR(A.A1_DTCAD) = 2020), 0)  +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000091') AND MONTH(A.A1_DTCAD) = 8 AND YEAR(A.A1_DTCAD) = 2020), 0)  +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000091') AND MONTH(A.A1_DTCAD) = 9 AND YEAR(A.A1_DTCAD) = 2020), 0)  +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000091') AND MONTH(A.A1_DTCAD) = 10 AND YEAR(A.A1_DTCAD) = 2020), 0) +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000091') AND MONTH(A.A1_DTCAD) = 11 AND YEAR(A.A1_DTCAD) = 2020), 0) +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000091') AND MONTH(A.A1_DTCAD) = 12 AND YEAR(A.A1_DTCAD) = 2020), 0) AS TOTAL
FROM SA1010 A, SA3010 B
WHERE A.D_E_L_E_T_ = ''
AND A.A1_VEND = B.A3_COD
AND A.A1_VEND IN('000091')
AND A.A1_DTCAD BETWEEN '20200101' AND '20200131'
GROUP BY A.A1_VEND,  MONTH(A.A1_DTCAD) , YEAR(A.A1_DTCAD), B.A3_NOME

/*-------------------------------------------------------------------------------*/




SELECT 
A.A1_VEND, 
B.A3_NOME,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000069') AND MONTH(A.A1_DTCAD) = 1 AND YEAR(A.A1_DTCAD) = 2020), 0) AS JAN,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000069') AND MONTH(A.A1_DTCAD) = 2 AND YEAR(A.A1_DTCAD) = 2020), 0) AS FEV,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000069') AND MONTH(A.A1_DTCAD) = 3 AND YEAR(A.A1_DTCAD) = 2020), 0) AS MAR,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000069') AND MONTH(A.A1_DTCAD) = 4 AND YEAR(A.A1_DTCAD) = 2020), 0) AS ABR,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000069') AND MONTH(A.A1_DTCAD) = 5 AND YEAR(A.A1_DTCAD) = 2020), 0) AS MAI,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000069') AND MONTH(A.A1_DTCAD) = 6 AND YEAR(A.A1_DTCAD) = 2020), 0) AS JUN,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000069') AND MONTH(A.A1_DTCAD) = 7 AND YEAR(A.A1_DTCAD) = 2020), 0) AS JUL,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000069') AND MONTH(A.A1_DTCAD) = 8 AND YEAR(A.A1_DTCAD) = 2020), 0) AS AGO,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000069') AND MONTH(A.A1_DTCAD) = 9 AND YEAR(A.A1_DTCAD) = 2020), 0) AS S_E_T,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000069') AND MONTH(A.A1_DTCAD) = 10 AND YEAR(A.A1_DTCAD) = 2020), 0) AS O_U_T,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000069') AND MONTH(A.A1_DTCAD) = 11 AND YEAR(A.A1_DTCAD) = 2020), 0) AS NOV,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000069') AND MONTH(A.A1_DTCAD) = 12 AND YEAR(A.A1_DTCAD) = 2020), 0) AS DEZ,
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000069') AND MONTH(A.A1_DTCAD) = 1 AND YEAR(A.A1_DTCAD) = 2020), 0)  +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000069') AND MONTH(A.A1_DTCAD) = 2 AND YEAR(A.A1_DTCAD) = 2020), 0)  +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000069') AND MONTH(A.A1_DTCAD) = 3 AND YEAR(A.A1_DTCAD) = 2020), 0)  +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000069') AND MONTH(A.A1_DTCAD) = 4 AND YEAR(A.A1_DTCAD) = 2020), 0)  +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000069') AND MONTH(A.A1_DTCAD) = 5 AND YEAR(A.A1_DTCAD) = 2020), 0)  +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000069') AND MONTH(A.A1_DTCAD) = 6 AND YEAR(A.A1_DTCAD) = 2020), 0)  +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000069') AND MONTH(A.A1_DTCAD) = 7 AND YEAR(A.A1_DTCAD) = 2020), 0)  +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000069') AND MONTH(A.A1_DTCAD) = 8 AND YEAR(A.A1_DTCAD) = 2020), 0)  +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000069') AND MONTH(A.A1_DTCAD) = 9 AND YEAR(A.A1_DTCAD) = 2020), 0)  +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000069') AND MONTH(A.A1_DTCAD) = 10 AND YEAR(A.A1_DTCAD) = 2020), 0) +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000069') AND MONTH(A.A1_DTCAD) = 11 AND YEAR(A.A1_DTCAD) = 2020), 0) +
ISNULL((SELECT COUNT(*) FROM SA1010 A WHERE A.D_E_L_E_T_ = '' AND A.A1_VEND IN('000069') AND MONTH(A.A1_DTCAD) = 12 AND YEAR(A.A1_DTCAD) = 2020), 0) AS TOTAL
FROM SA1010 A, SA3010 B
WHERE A.D_E_L_E_T_ = ''
AND A.A1_VEND = B.A3_COD
AND A.A1_VEND IN('000069')
AND A.A1_DTCAD BETWEEN '20200101' AND '20200131'
GROUP BY A.A1_VEND,  MONTH(A.A1_DTCAD) , YEAR(A.A1_DTCAD), B.A3_NOME

/*-----------------------------------------------------------------------*/

SELECT
A.A3_COD,
A.A3_NOME, 
B.A1_COD, 
B.A1_NOME ,
CONVERT(VARCHAR,CAST(B.A1_DTCAD AS DATETIME),103) AS DT_CAD
FROM SA3010 A, SA1010 B
WHERE A.D_E_L_E_T_ = ''
AND B.D_E_L_E_T_ = ''
AND A.A3_COD = B.A1_VEND
AND B.A1_VEND IN('000091')
AND B.A1_DTCAD BETWEEN '20200101' AND '20201231'








