
SELECT 
SF1.F1_FILIAL	AS FILIAL,
SF1.F1_SERIE	AS SERIE,
SF1.F1_DOC		AS DOC,
SF1.F1_EMISSAO	AS EMISSAO,
SF1.F1_DTDIGIT	AS DTDIGIT,
SF1.F1_TIPO		AS TIPO,
CASE
	WHEN SF1.F1_TIPO = 'D'
THEN SA1.A1_COD
	WHEN SF1.F1_TIPO <> 'D'
THEN SA2.A2_COD
ELSE ''
END	AS COD_CLIFOR,
CASE
	WHEN SF1.F1_TIPO = 'D'
THEN SA1.A1_NOME
	WHEN SF1.F1_TIPO <> 'D'
THEN SA2.A2_NOME
ELSE ''
END AS CLIFOR,
SD1.D1_COD		AS CODPROD,
SB1.B1_ZDESRDZ	AS PRODUTO,
SD1.D1_TES		AS TES,
SF4.F4_DUPLIC	AS FIN,
SF4.F4_ESTOQUE	AS ESTOQUE,
SD1.D1_PICM		AS P_ICM,
SD1.D1_IPI		AS P_IPI,	
SD1.D1_LOCAL	AS ARMZ,
SD1.D1_QUANT	AS QTD,
SD1.D1_VUNIT	AS VLR_UNI,
SD1.D1_TOTAL	AS VLR_MERC,
SD1.D1_VALICM	AS VLR_ICM,
SD1.D1_VALIPI	AS VLR_IPI,
SD1.D1_VALFRE	AS VLR_FRETE,
D1_DESPESA		AS DESPESA,
D1_VALDESC		AS DESCONTO,
SF1.F1_VALBRUT	AS VLR_TOTAL,
CASE
	WHEN SE2_1.E2_PARCELA <> ''
THEN SE2_1.E2_PARCELA
ELSE SE2.E2_PARCELA
END AS PARCELA,
CASE
	WHEN SE2_1.E2_PARCELA <> ''
THEN SE2_1.E2_VENCREA
ELSE SE2.E2_VENCREA
END AS VENCIMENTO,
CASE
	WHEN SE2_1.E2_PARCELA <> ''
THEN SE2_1.E2_VALOR
ELSE SE2.E2_VALOR
END AS VALOR,
SE2_2.E2_PARCELA AS PARCELA,
SE2_2.E2_VENCREA AS VENCIMENTO,
SE2_2.E2_VALOR	 AS VALOR,
SE2_3.E2_PARCELA AS PARCELA,
SE2_3.E2_VENCREA AS VENCIMENTO,
SE2_3.E2_VALOR	 AS VALOR,
SE2_4.E2_PARCELA AS PARCELA,
SE2_4.E2_VENCREA AS VENCIMENTO,
SE2_4.E2_VALOR	 AS VALOR,
SE2_5.E2_PARCELA AS PARCELA,
SE2_5.E2_VENCREA AS VENCIMENTO,
SE2_5.E2_VALOR	 AS VALOR,
SE2_6.E2_PARCELA AS PARCELA,
SE2_6.E2_VENCREA AS VENCIMENTO,
SE2_6.E2_VALOR	 AS VALOR,
SE2_7.E2_PARCELA AS PARCELA,
SE2_7.E2_VENCREA AS VENCIMENTO,
SE2_7.E2_VALOR	 AS VALOR,
SE2_8.E2_PARCELA AS PARCELA,
SE2_8.E2_VENCREA AS VENCIMENTO,
SE2_8.E2_VALOR	 AS VALOR,
SE2_9.E2_PARCELA AS PARCELA,
SE2_9.E2_VENCREA AS VENCIMENTO,
SE2_9.E2_VALOR	 AS VALOR,
SE2_10.E2_PARCELA AS PARCELA,
SE2_10.E2_VENCREA AS VENCIMENTO,
SE2_10.E2_VALOR	 AS VALOR
FROM SF1010 SF1
LEFT JOIN SD1010 SD1 ON SD1.D_E_L_E_T_ = '' AND SD1.D1_FILIAL = SF1.F1_FILIAL AND SD1.D1_SERIE = SF1.F1_SERIE AND SD1.D1_DOC = SF1.F1_DOC AND SD1.D1_FORNECE = SF1.F1_FORNECE
LEFT JOIN SB1010 SB1 ON SB1.D_E_L_E_T_ = '' AND SB1.B1_COD = SD1.D1_COD
LEFT JOIN SF4010 SF4 ON SF4.D_E_L_E_T_ = '' AND SF4.F4_CODIGO = SD1.D1_TES
LEFT JOIN SA1010 SA1 ON SA1.D_E_L_E_T_ = '' AND SA1.A1_COD = SF1.F1_FORNECE AND SA1.A1_LOJA = SF1.F1_LOJA AND SF1.F1_TIPO = 'D'
LEFT JOIN SA2010 SA2 ON SA2.D_E_L_E_T_ = '' AND SA2.A2_COD = SF1.F1_FORNECE AND SA2.A2_LOJA = SF1.F1_LOJA AND SF1.F1_TIPO <> 'D'
LEFT JOIN SE2010 SE2 ON SE2.D_E_L_E_T_ = '' AND SE2.E2_FILIAL = SF1.F1_FILIAL AND SE2.E2_PREFIXO = SF1.F1_SERIE AND SE2.E2_NUM = SF1.F1_DOC AND SE2.E2_FORNECE = SF1.F1_FORNECE AND SE2.E2_LOJA = SF1.F1_LOJA AND SE2.E2_PARCELA = ''
LEFT JOIN SE2010 SE2_1 ON SE2_1.D_E_L_E_T_ = '' AND SE2_1.E2_FILIAL = SF1.F1_FILIAL AND SE2_1.E2_PREFIXO = SF1.F1_SERIE AND SE2_1.E2_NUM = SF1.F1_DOC AND SE2_1.E2_FORNECE = SF1.F1_FORNECE AND SE2_1.E2_LOJA = SF1.F1_LOJA AND SE2_1.E2_PARCELA = '1'
LEFT JOIN SE2010 SE2_2 ON SE2_2.D_E_L_E_T_ = '' AND SE2_2.E2_FILIAL = SF1.F1_FILIAL AND SE2_2.E2_PREFIXO = SF1.F1_SERIE AND SE2_2.E2_NUM = SF1.F1_DOC AND SE2_2.E2_FORNECE = SF1.F1_FORNECE AND SE2_2.E2_LOJA = SF1.F1_LOJA AND SE2_2.E2_PARCELA = '2'
LEFT JOIN SE2010 SE2_3 ON SE2_3.D_E_L_E_T_ = '' AND SE2_3.E2_FILIAL = SF1.F1_FILIAL AND SE2_3.E2_PREFIXO = SF1.F1_SERIE AND SE2_3.E2_NUM = SF1.F1_DOC AND SE2_3.E2_FORNECE = SF1.F1_FORNECE AND SE2_3.E2_LOJA = SF1.F1_LOJA AND SE2_3.E2_PARCELA = '3'
LEFT JOIN SE2010 SE2_4 ON SE2_4.D_E_L_E_T_ = '' AND SE2_4.E2_FILIAL = SF1.F1_FILIAL AND SE2_4.E2_PREFIXO = SF1.F1_SERIE AND SE2_4.E2_NUM = SF1.F1_DOC AND SE2_4.E2_FORNECE = SF1.F1_FORNECE AND SE2_4.E2_LOJA = SF1.F1_LOJA AND SE2_4.E2_PARCELA = '4'
LEFT JOIN SE2010 SE2_5 ON SE2_5.D_E_L_E_T_ = '' AND SE2_5.E2_FILIAL = SF1.F1_FILIAL AND SE2_5.E2_PREFIXO = SF1.F1_SERIE AND SE2_5.E2_NUM = SF1.F1_DOC AND SE2_5.E2_FORNECE = SF1.F1_FORNECE AND SE2_5.E2_LOJA = SF1.F1_LOJA AND SE2_5.E2_PARCELA = '5'
LEFT JOIN SE2010 SE2_6 ON SE2_6.D_E_L_E_T_ = '' AND SE2_6.E2_FILIAL = SF1.F1_FILIAL AND SE2_6.E2_PREFIXO = SF1.F1_SERIE AND SE2_6.E2_NUM = SF1.F1_DOC AND SE2_6.E2_FORNECE = SF1.F1_FORNECE AND SE2_6.E2_LOJA = SF1.F1_LOJA AND SE2_6.E2_PARCELA = '6'
LEFT JOIN SE2010 SE2_7 ON SE2_7.D_E_L_E_T_ = '' AND SE2_7.E2_FILIAL = SF1.F1_FILIAL AND SE2_7.E2_PREFIXO = SF1.F1_SERIE AND SE2_7.E2_NUM = SF1.F1_DOC AND SE2_7.E2_FORNECE = SF1.F1_FORNECE AND SE2_7.E2_LOJA = SF1.F1_LOJA AND SE2_7.E2_PARCELA = '7'
LEFT JOIN SE2010 SE2_8 ON SE2_8.D_E_L_E_T_ = '' AND SE2_8.E2_FILIAL = SF1.F1_FILIAL AND SE2_8.E2_PREFIXO = SF1.F1_SERIE AND SE2_8.E2_NUM = SF1.F1_DOC AND SE2_8.E2_FORNECE = SF1.F1_FORNECE AND SE2_8.E2_LOJA = SF1.F1_LOJA AND SE2_8.E2_PARCELA = '8'
LEFT JOIN SE2010 SE2_9 ON SE2_9.D_E_L_E_T_ = '' AND SE2_9.E2_FILIAL = SF1.F1_FILIAL AND SE2_9.E2_PREFIXO = SF1.F1_SERIE AND SE2_9.E2_NUM = SF1.F1_DOC AND SE2_9.E2_FORNECE = SF1.F1_FORNECE AND SE2_9.E2_LOJA = SF1.F1_LOJA AND SE2_9.E2_PARCELA = '9'
LEFT JOIN SE2010 SE2_10 ON SE2_10.D_E_L_E_T_ = '' AND SE2_10.E2_FILIAL = SF1.F1_FILIAL AND SE2_10.E2_PREFIXO = SF1.F1_SERIE AND SE2_10.E2_NUM = SF1.F1_DOC AND SE2_10.E2_FORNECE = SF1.F1_FORNECE AND SE2_10.E2_LOJA = SF1.F1_LOJA AND SE2_10.E2_PARCELA = '10'
WHERE 1=1
AND SF1.D_E_L_E_T_ = '' 
AND SF1.F1_DOC = '000003697' 







