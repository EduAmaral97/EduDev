
/*

Mapa de Vendas com Apresentação Reservas Técnicas ( Oficial )

*/

SELECT 
	A.E3_FILIAL 	AS CodFil,
	A.E3_VEND		AS CodVnd,
	B.A3_NREDUZ		AS NomVnd,
	CONVERT(VARCHAR,CAST(A.E3_EMISSAO AS DATETIME),103) AS Emissao,
--	A.E3_CODCLI 	AS CodCli,
--	A.E3_LOJA		AS LojCli,
--	C.A1_NREDUZ,RTRIM(C.A1_MUN)+'/'+C.A1_EST AS CidUF, 
	A.E3_SERIE		AS SerDoc,
	A.E3_NUM		AS NumDoc,
	A.E3_PARCELA	AS Parc,
	A.E3_TIPO		AS TipDoc,
	BasCom  = CASE WHEN A.E3_BASE >= 0 AND  A.E3_ZCODRT <> '9' THEN A.E3_BASE ELSE 0 END,
--	VlrCom  = CASE WHEN                     A.E3_ZCODRT <> '9' THEN A.E3_BASE ELSE 0 END,A.E3_PORC,A.E3_COMIS,
	VlrCom  = CASE WHEN A.E3_BASE <  0 AND  A.E3_ZCODRT =  '9' THEN A.E3_BASE ELSE 0 END, 
	RTecInd = CASE WHEN A.E3_BASE <  0 AND  A.E3_ZCODRT =  '1' THEN A.E3_BASE ELSE 0 END,
	RTecMO  = CASE WHEN A.E3_BASE <  0 AND  A.E3_ZCODRT =  '2' THEN A.E3_BASE ELSE 0 END,
	RTecFrt = CASE WHEN A.E3_BASE <  0 AND  A.E3_ZCODRT =  '3' THEN A.E3_BASE ELSE 0 END,
	RTecCC  = CASE WHEN A.E3_BASE <  0 AND  A.E3_ZCODRT =  '4' THEN A.E3_BASE ELSE 0 END,
	DevCmp  = CASE WHEN A.E3_BASE <  0 AND  A.E3_ZCODRT =  '5' THEN A.E3_BASE ELSE 0 END,
	IndQlf  = CASE WHEN A.E3_BASE >  0 AND  A.E3_ZCODRT =  '6' THEN A.E3_BASE ELSE 0 END,
	IndCop  = CASE WHEN A.E3_BASE <  0 AND  A.E3_ZCODRT =  '6' THEN A.E3_BASE ELSE 0 END,
	ComAnt  = CASE WHEN A.E3_BASE >  0 AND  A.E3_ZCODRT =  '7' THEN A.E3_BASE ELSE 0 END,
	Outros  = CASE WHEN A.E3_BASE <  0 AND  A.E3_ZCODRT =  '8' THEN A.E3_BASE ELSE 0 END,
	FinNCC  = CASE WHEN A.E3_BASE <  0 AND  A.E3_ZCODRT =  '9' THEN A.E3_BASE ELSE 0 END
FROM SE3010 AS A
	LEFT JOIN SA3010 AS B ON B.D_E_L_E_T_ = '' AND B.A3_COD = A.E3_VEND
	LEFT JOIN SA1010 AS C ON C.D_E_L_E_T_ = '' AND C.A1_COD = A.E3_CODCLI AND C.A1_LOJA = A.E3_LOJA
WHERE A.D_E_L_E_T_ = '' 
	AND A.E3_EMISSAO 	BETWEEN '20210401' 	AND '20210430' 
	AND A.E3_FILIAL 	BETWEEN '0103' 		AND '0103'
	AND A.E3_VEND 		BETWEEN '000030' 	AND '000030'
--	AND C.A1_COD  		BETWEEN '025634'   	AND '025634'	
--	AND B.A3_ZLOCVND IN ('Z','M')
--	AND B.A3_ZLOCVND IN ('L')
--	AND A.E3_FILIAL = '0101'
--	AND A.E3_SERIE  = '700'
--	AND A.E3_NUM	= '000003236'
--	AND A.E3_BASE	= 21520
ORDER BY A.E3_FILIAL,A.E3_VEND,A.E3_SERIE,A.E3_NUM,A.E3_PARCELA,A.E3_TIPO

/*
SELECT * FROM ZCUBO WHERE 1 = 1 AND Z_FILIAL_ATM = '0101' AND Z_NUM_ATM = '028051'
SELECT * FROM SUB010 WHERE D_E_L_E_T_ = '' AND UB_FILIAL = '0101' AND UB_NUM = '028051'


SELECT * FROM SC6010 WHERE D_E_L_E_T_ = '' AND C6_FILIAL = '0101' AND C6_NOTA = '000028233'
SELECT * FROM SC7010 WHERE D_E_L_E_T_


SELECT * FROM SA1010 WHERE D_E_L_E_T_ = '' AND A1_NOME LIKE '%DOSSO%'
SELECT L1_DOC,L1_SERIE,L1_DOCPED,L1_SERPED, * FROM SL1010 WHERE D_E_L_E_T_ = '' AND L1_CLIENTE = '033095'
SELECT * FROM SE3010 WHERE D_E_L_E_T_ = '' AND E3_FILIAL  = '0101' AND E3_NUM = '000003508' AND E3_SERIE = '700'
SELECT * FROM SE3010 WHERE D_E_L_E_T_ = '' AND E3_FILIAL  = '0101' AND E3_NUM = '000028147' AND E3_SERIE = '001'
SELECT * FROM SE1010 WHERE D_E_L_E_T_ = '' AND E1_PREFIXO = '001'  AND E1_NUM = '000028147'
*/

/*
SELECT A.B1_PROC,A.B1_LOJPROC,B.A2_NREDUZ,A.B1_COD,A.B1_DESC,C.B2_QATU,C.B2_RESERVA,(C.B2_QATU-C.B2_RESERVA) AS SLDDISP,A.B1_UM
FROM SB1010 AS A 
LEFT JOIN SA2010 AS B ON B.D_E_L_E_T_ = '' AND B.A2_COD = A.B1_PROC AND B.A2_LOJA = A.B1_LOJPROC
LEFT JOIN SB2010 AS C ON C.D_E_L_E_T_ = '' AND C.B2_COD =  A.B1_COD AND C.B2_LOCAL IN ('01','05')
WHERE A.D_E_L_E_T_ = ''
AND A.B1_MSBLQL = '2'
AND SUBSTRING(A.B1_GRUPO,1,2) = 'MR'
AND A.B1_PROC <> ''
AND C.B2_QATU <> 0
ORDER BY 1,2


SELECT L1_DOC,L1_SERIE,L1_DOCPED,L1_SERPED, * FROM SL1010 WHERE D_E_L_E_T_ = '' AND L1_NUMATEN = '025953'
SELECT * FROM SL2010 WHERE D_E_L_E_T_ = '' AND L2_NUM = '018288'

SELECT B1_CUSTD, * FROM SB1010 WHERE D_E_L_E_T_ = '' AND B1_COD = 'IC289F'

SELECT * FROM DA1010 WHERE D_E_L_E_T_ = '' AND DA1_CODPRO = 'IC289F'

SELECT L2_FILIAL,L2_EMISSAO,L2_NUM, L2_ITEM,L2_PRODUTO,L2_DESCRI,L2_QUANT,L2_VRUNIT,L2_VALDESC,L2_VLRITEM,L2_ZCSTREP  
FROM SL2010 
WHERE D_E_L_E_T_ = '' 
AND L2_NUM = '018288'
*/

