--------------------------CREAT TABLE------------------------/


CREATE TABLE #SALDO_ESTOQUE_MENSAL
    (
     SEM_CODPROD VARCHAR(15),
   	 SEM_PRODUTO VARCHAR(70),
	 SEM_UND	 VARCHAR(2),
	 SEM_CUSTPROD FLOAT,
     Z201801 FLOAT,
     ZCUST201801 FLOAT,
     Z201802 FLOAT,
     ZCUST201802 FLOAT,
     Z201803 FLOAT,
     ZCUST201803 FLOAT,
     Z201804 FLOAT,
     ZCUST201804 FLOAT,
     Z201805 FLOAT,
     ZCUST201805 FLOAT,
     Z201806 FLOAT,
     ZCUST201806 FLOAT,
     Z201807 FLOAT,
     ZCUST201807 FLOAT,
     Z201808 FLOAT,
     ZCUST201808 FLOAT,
     Z201809 FLOAT,
     ZCUST201809 FLOAT,
     Z201810 FLOAT,
     ZCUST201810 FLOAT,
     Z201811 FLOAT,
     ZCUST201811 FLOAT,
     Z201812 FLOAT,
     ZCUST201812 FLOAT,
     Z201901 FLOAT,
     ZCUST201901 FLOAT,
     Z201902 FLOAT,
     ZCUST201902 FLOAT,
     Z201903 FLOAT,
     ZCUST201903 FLOAT,
     Z201904 FLOAT,
     ZCUST201904 FLOAT,
     Z201905 FLOAT,
     ZCUST201905 FLOAT,
     Z201906 FLOAT,
     ZCUST201906 FLOAT,
     Z201907 FLOAT,
     ZCUST201907 FLOAT,
     Z201908 FLOAT,
     ZCUST201908 FLOAT,
     Z201909 FLOAT,
     ZCUST201909 FLOAT,
     Z201910 FLOAT,
     ZCUST201910 FLOAT,
     Z201911 FLOAT,
     ZCUST201911 FLOAT,
     Z201912 FLOAT,
     ZCUST201912 FLOAT,
     Z202001 FLOAT,
     ZCUST202001 FLOAT,
     Z202002 FLOAT,
     ZCUST202002 FLOAT,
     Z202003 FLOAT,
     ZCUST202003 FLOAT,
     Z202004 FLOAT,
     ZCUST202004 FLOAT
    )
    
   

/-----------------INSERT NA TABELA TEMPORARIA----------------------/

INSERT INTO #SALDO_ESTOQUE_MENSAL (SEM_CODPROD, SEM_PRODUTO, SEM_UND, SEM_CUSTPROD, Z201801, ZCUST201801) 
SELECT * FROM #AUX

/*---------------------------------------------------------------*/

UPDATE
    #SALDO_ESTOQUE_MENSAL
SET
    #SALDO_ESTOQUE_MENSAL.Z201802 = #AUX.SALDO_FINAL,
    #SALDO_ESTOQUE_MENSAL.ZCUST201802 = #AUX.CUSTO_FINAL
FROM
    #SALDO_ESTOQUE_MENSAL
INNER JOIN
    #AUX
ON
    #SALDO_ESTOQUE_MENSAL.SEM_CODPROD = #AUX.CODPROD


/---------------SELECT TABELA TEMPORARIA--------------------/


SELECT 
 	 *
FROM #SALDO_ESTOQUE_MENSAL
WHERE SEM_CODPROD = 'LB012F'


/---------------DROP TABELA---------------------------/


DROP TABLE #SALDO_ESTOQUE_MENSAL 


/--------------------FIM------------------------------/
