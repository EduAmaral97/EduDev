/*

FILTROS BENNER

SELECT NOME FROM CN_TIPOSCONTRATOS WHERE HANDLE IN (11, 20, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 53, 54, 55)


SELECT NOME FROM EMPRESAS WHERE HANDLE IN (1, 2, 3, 5, 17, 18)

*/



SELECT 
A.BA1_NOMUSR    AS NOME,
A.BA1_CPFUSR    AS CPF,
CASE
    WHEN A.BA1_CODEMP IN ('0003','0006') THEN CLI1.A1_CGC
    WHEN A.BA1_CODEMP IN ('0004','0005') THEN C.BQC_CNPJ
    ELSE ''
END             AS CNPJ,
CASE
    WHEN A.BA1_CODEMP IN ('0003','0006') THEN CLI1.A1_NOME
    WHEN A.BA1_CODEMP IN ('0004','0005') THEN C.BQC_DESCRI
    ELSE ''
END            AS EMPRESA_CLIENTE,
ISNULL((SELECT TOP 1 SC.M0_NOMECOM FROM SYS_COMPANY SC WHERE SUBSTRING(SC.M0_CODFIL,1,3) = A.BA1_FILIAL),'')  AS EMPRESA,
E.BII_DESCRI   AS TIPO_CONTRATO,
CASE
    WHEN A.BA1_CODEMP IN ('0003','0006') THEN B.BA3_IDBENN
    ELSE A.BA1_SUBCON
END             AS ID_CONTRATO,
A.BA1_XCARTE    AS CODIGO_ASSOCIADO
FROM BA1010 A
LEFT JOIN BA3010 B ON A.BA1_FILIAL = B.BA3_FILIAL AND A.BA1_CODINT = B.BA3_CODINT AND A.BA1_CODEMP = B.BA3_CODEMP AND A.BA1_CONEMP = B.BA3_CONEMP AND A.BA1_SUBCON = B.BA3_SUBCON AND A.BA1_MATRIC = B.BA3_MATRIC AND B.D_E_L_E_T_ = ''
LEFT JOIN BQC010 C ON B.BA3_CODINT = C.BQC_CODINT AND B.BA3_CODEMP = C.BQC_CODEMP AND B.BA3_CONEMP = C.BQC_NUMCON AND B.BA3_SUBCON = C.BQC_SUBCON AND C.D_E_L_E_T_ = ''
LEFT JOIN SA1010 CLI1 ON CLI1.A1_COD = B.BA3_CODCLI AND B.BA3_CODEMP IN ('0003','0006') AND CLI1.D_E_L_E_T_ = ''
LEFT JOIN BT5010 D ON D.BT5_CODINT = A.BA1_CODINT AND D.BT5_CODIGO = A.BA1_CODEMP AND D.BT5_NUMCON = A.BA1_CONEMP AND D.D_E_L_E_T_ = ''
LEFT JOIN BII010 E ON E.BII_CODIGO = D.BT5_TIPCON AND E.D_E_L_E_T_ = ''
WHERE 1=1
AND A.D_E_L_E_T_ = ''
AND A.BA1_MOTBLO = ''
AND A.BA1_FILIAL IN ('001','002','003','005','008','016','021')
AND A.BA1_CODEMP IN ('0003','0006','0004','0005')
AND A.BA1_CONEMP IN ('000000000003','000000000004','000000000005','000000000006','000000000007','0000000000080', '000000000002','000000000010','000000000012','000000000014','000000000017','000000000028','000000000031')
AND A.BA1_XCARTE = 'TF-01304529-01'

