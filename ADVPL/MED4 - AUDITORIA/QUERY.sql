
/* FOENEEDOR */


SELECT 
A.A2_COD,
A.A2_NOME,
SUBSTRING(A.A2_USERLGI, 11,1)+
SUBSTRING(A.A2_USERLGI, 15,1)+
SUBSTRING(A.A2_USERLGI, 2, 1)+
SUBSTRING(A.A2_USERLGI, 6, 1)+
SUBSTRING(A.A2_USERLGI, 10,1)+
SUBSTRING(A.A2_USERLGI, 14,1)+
SUBSTRING(A.A2_USERLGI, 1, 1)+
SUBSTRING(A.A2_USERLGI, 5, 1)+
SUBSTRING(A.A2_USERLGI, 9, 1)+
SUBSTRING(A.A2_USERLGI, 13,1)+
SUBSTRING(A.A2_USERLGI, 17,1)+
SUBSTRING(A.A2_USERLGI, 4, 1) AS COD_Usuario_CRIACAO,
UCRI.USR_CODIGO AS USUARIO_CRI,
 CASE WHEN SUBSTRING(A2_USERLGI, 03, 1) != ' ' AND A2_USERLGI != '' THEN
        CONVERT(VARCHAR,DATEADD(DAY,CONVERT(INT,CONCAT(ASCII(SUBSTRING(A2_USERLGI,12,1)) - 50, ASCII(SUBSTRING(A2_USERLGI,16,1)) - 50) + IIF(SUBSTRING(A2_USERLGI,08,1) = '<',10000,0)),'1996-01-01'), 103)
    ELSE 
        ''
    END AS DATA_INCL,
SUBSTRING(A.A2_USERLGA, 11,1)+
SUBSTRING(A.A2_USERLGA, 15,1)+
SUBSTRING(A.A2_USERLGA, 2, 1)+
SUBSTRING(A.A2_USERLGA, 6, 1)+
SUBSTRING(A.A2_USERLGA, 10,1)+
SUBSTRING(A.A2_USERLGA, 14,1)+
SUBSTRING(A.A2_USERLGA, 1, 1)+
SUBSTRING(A.A2_USERLGA, 5, 1)+
SUBSTRING(A.A2_USERLGA, 9, 1)+
SUBSTRING(A.A2_USERLGA, 13,1)+
SUBSTRING(A.A2_USERLGA, 17,1)+
SUBSTRING(A.A2_USERLGA, 4, 1) COD_Usuario_ALTERACAO,
UALT.USR_CODIGO AS USUARIO_ALT,
   CASE WHEN SUBSTRING(A2_USERLGA, 03, 1) != ' ' AND A2_USERLGA != '' THEN
        CONVERT(VARCHAR,DATEADD(DAY,CONVERT(INT,CONCAT(ASCII(SUBSTRING(A2_USERLGA,12,1)) - 50, ASCII(SUBSTRING(A2_USERLGA,16,1)) - 50) + IIF(SUBSTRING(A2_USERLGA,08,1) = '<',10000,0)),'1996-01-01'), 103)
    ELSE ''
    END AS DATA_ALT
FROM SA2010 A
LEFT JOIN SYS_USR UCRI ON UCRI.D_E_L_E_T_ = '' AND UCRI.USR_ID = SUBSTRING(A.A2_USERLGI, 11,1)+SUBSTRING(A.A2_USERLGI, 15,1)+SUBSTRING(A.A2_USERLGI, 2, 1)+SUBSTRING(A.A2_USERLGI, 6, 1)+SUBSTRING(A.A2_USERLGI, 10,1)+SUBSTRING(A.A2_USERLGI, 14,1)+SUBSTRING(A.A2_USERLGI, 1, 1)+SUBSTRING(A.A2_USERLGI, 5, 1)+SUBSTRING(A.A2_USERLGI, 9, 1)+SUBSTRING(A.A2_USERLGI, 13,1)+SUBSTRING(A.A2_USERLGI, 17,1)+SUBSTRING(A.A2_USERLGI, 4, 1)
LEFT JOIN SYS_USR UALT ON UALT.D_E_L_E_T_ = '' AND UALT.USR_ID = SUBSTRING(A.A2_USERLGA, 11,1)+SUBSTRING(A.A2_USERLGA, 15,1)+SUBSTRING(A.A2_USERLGA, 2, 1)+SUBSTRING(A.A2_USERLGA, 6, 1)+SUBSTRING(A.A2_USERLGA, 10,1)+SUBSTRING(A.A2_USERLGA, 14,1)+SUBSTRING(A.A2_USERLGA, 1, 1)+SUBSTRING(A.A2_USERLGA, 5, 1)+SUBSTRING(A.A2_USERLGA, 9, 1)+SUBSTRING(A.A2_USERLGA, 13,1)+SUBSTRING(A.A2_USERLGA, 17,1)+SUBSTRING(A.A2_USERLGA, 4, 1) 
WHERE 1=1
AND A.D_E_L_E_T_ = ''
AND A.A2_COD = '010469'



/* PEDIDO DE COMPRAS*/

SELECT 
A.C7_FILIAL,
A.C7_NUM,
A.C7_PRODUTO,
A.C7_DESCRI,
A.C7_TOTAL,
A.C7_FORNECE,
A.C7_EMISSAO,
A.C7_USER,
SUBSTRING(A.C7_USERLGI, 11,1)+
SUBSTRING(A.C7_USERLGI, 15,1)+
SUBSTRING(A.C7_USERLGI, 2, 1)+
SUBSTRING(A.C7_USERLGI, 6, 1)+
SUBSTRING(A.C7_USERLGI, 10,1)+
SUBSTRING(A.C7_USERLGI, 14,1)+
SUBSTRING(A.C7_USERLGI, 1, 1)+
SUBSTRING(A.C7_USERLGI, 5, 1)+
SUBSTRING(A.C7_USERLGI, 9, 1)+
SUBSTRING(A.C7_USERLGI, 13,1)+
SUBSTRING(A.C7_USERLGI, 17,1)+
SUBSTRING(A.C7_USERLGI, 4, 1) AS COD_Usuario_CRIACAO,
UCRI.USR_CODIGO AS USUARIO_CRI,
 CASE WHEN SUBSTRING(C7_USERLGI, 03, 1) != ' ' AND C7_USERLGI != '' THEN
        CONVERT(VARCHAR,DATEADD(DAY,CONVERT(INT,CONCAT(ASCII(SUBSTRING(C7_USERLGI,12,1)) - 50, ASCII(SUBSTRING(C7_USERLGI,16,1)) - 50) + IIF(SUBSTRING(C7_USERLGI,08,1) = '<',10000,0)),'1996-01-01'), 103)
    ELSE ''
    END AS DATA_INCL,
SUBSTRING(A.C7_USERLGA, 11,1)+
SUBSTRING(A.C7_USERLGA, 15,1)+
SUBSTRING(A.C7_USERLGA, 2, 1)+
SUBSTRING(A.C7_USERLGA, 6, 1)+
SUBSTRING(A.C7_USERLGA, 10,1)+
SUBSTRING(A.C7_USERLGA, 14,1)+
SUBSTRING(A.C7_USERLGA, 1, 1)+
SUBSTRING(A.C7_USERLGA, 5, 1)+
SUBSTRING(A.C7_USERLGA, 9, 1)+
SUBSTRING(A.C7_USERLGA, 13,1)+
SUBSTRING(A.C7_USERLGA, 17,1)+
SUBSTRING(A.C7_USERLGA, 4, 1) COD_Usuario_ALTERACAO,
UALT.USR_CODIGO AS USUARIO_ALT,
   CASE WHEN SUBSTRING(C7_USERLGA, 03, 1) != ' ' AND C7_USERLGA != '' THEN
        CONVERT(VARCHAR,DATEADD(DAY,CONVERT(INT,CONCAT(ASCII(SUBSTRING(C7_USERLGA,12,1)) - 50, ASCII(SUBSTRING(C7_USERLGA,16,1)) - 50) + IIF(SUBSTRING(C7_USERLGA,08,1) = '<',10000,0)),'1996-01-01'), 103)
    ELSE ''
    END AS DATA_ALT
FROM SC7010 A
LEFT JOIN SYS_USR UCRI ON UCRI.D_E_L_E_T_ = '' AND UCRI.USR_ID = SUBSTRING(A.C7_USERLGI, 11,1)+SUBSTRING(A.C7_USERLGI, 15,1)+SUBSTRING(A.C7_USERLGI, 2, 1)+SUBSTRING(A.C7_USERLGI, 6, 1)+SUBSTRING(A.C7_USERLGI, 10,1)+SUBSTRING(A.C7_USERLGI, 14,1)+SUBSTRING(A.C7_USERLGI, 1, 1)+SUBSTRING(A.C7_USERLGI, 5, 1)+SUBSTRING(A.C7_USERLGI, 9, 1)+SUBSTRING(A.C7_USERLGI, 13,1)+SUBSTRING(A.C7_USERLGI, 17,1)+SUBSTRING(A.C7_USERLGI, 4, 1)
LEFT JOIN SYS_USR UALT ON UALT.D_E_L_E_T_ = '' AND UALT.USR_ID = SUBSTRING(A.C7_USERLGA, 11,1)+SUBSTRING(A.C7_USERLGA, 15,1)+SUBSTRING(A.C7_USERLGA, 2, 1)+SUBSTRING(A.C7_USERLGA, 6, 1)+SUBSTRING(A.C7_USERLGA, 10,1)+SUBSTRING(A.C7_USERLGA, 14,1)+SUBSTRING(A.C7_USERLGA, 1, 1)+SUBSTRING(A.C7_USERLGA, 5, 1)+SUBSTRING(A.C7_USERLGA, 9, 1)+SUBSTRING(A.C7_USERLGA, 13,1)+SUBSTRING(A.C7_USERLGA, 17,1)+SUBSTRING(A.C7_USERLGA, 4, 1) 
WHERE 1=1
AND A.D_E_L_E_T_ = '*'
AND A.C7_NUM = '000473'
AND A.C7_FILIAL = '015001'


/* DOCUMENTO DE ENTRADA */

SELECT 
A.F1_FILIAL,
A.F1_SERIE,
A.F1_DOC,
A.F1_VALBRUT,
A.F1_DTDIGIT,
SUBSTRING(A.F1_USERLGI, 11,1)+
SUBSTRING(A.F1_USERLGI, 15,1)+
SUBSTRING(A.F1_USERLGI, 2, 1)+
SUBSTRING(A.F1_USERLGI, 6, 1)+
SUBSTRING(A.F1_USERLGI, 10,1)+
SUBSTRING(A.F1_USERLGI, 14,1)+
SUBSTRING(A.F1_USERLGI, 1, 1)+
SUBSTRING(A.F1_USERLGI, 5, 1)+
SUBSTRING(A.F1_USERLGI, 9, 1)+
SUBSTRING(A.F1_USERLGI, 13,1)+
SUBSTRING(A.F1_USERLGI, 17,1)+
SUBSTRING(A.F1_USERLGI, 4, 1) AS COD_Usuario_CRIACAO,
UCRI.USR_CODIGO AS USUARIO_CRI,
 CASE WHEN SUBSTRING(F1_USERLGI, 03, 1) != ' ' AND F1_USERLGI != '' THEN
        CONVERT(VARCHAR,DATEADD(DAY,CONVERT(INT,CONCAT(ASCII(SUBSTRING(F1_USERLGI,12,1)) - 50, ASCII(SUBSTRING(F1_USERLGI,16,1)) - 50) + IIF(SUBSTRING(F1_USERLGI,08,1) = '<',10000,0)),'1996-01-01'), 103)
    ELSE 
        ''
    END AS DATA_INCL,
SUBSTRING(A.F1_USERLGA, 11,1)+
SUBSTRING(A.F1_USERLGA, 15,1)+
SUBSTRING(A.F1_USERLGA, 2, 1)+
SUBSTRING(A.F1_USERLGA, 6, 1)+
SUBSTRING(A.F1_USERLGA, 10,1)+
SUBSTRING(A.F1_USERLGA, 14,1)+
SUBSTRING(A.F1_USERLGA, 1, 1)+
SUBSTRING(A.F1_USERLGA, 5, 1)+
SUBSTRING(A.F1_USERLGA, 9, 1)+
SUBSTRING(A.F1_USERLGA, 13,1)+
SUBSTRING(A.F1_USERLGA, 17,1)+
SUBSTRING(A.F1_USERLGA, 4, 1) COD_Usuario_ALTERACAO,
UALT.USR_CODIGO AS USUARIO_ALT,
   CASE WHEN SUBSTRING(F1_USERLGA, 03, 1) != ' ' AND F1_USERLGA != '' THEN
        CONVERT(VARCHAR,DATEADD(DAY,CONVERT(INT,CONCAT(ASCII(SUBSTRING(F1_USERLGA,12,1)) - 50, ASCII(SUBSTRING(F1_USERLGA,16,1)) - 50) + IIF(SUBSTRING(F1_USERLGA,08,1) = '<',10000,0)),'1996-01-01'), 103)
    ELSE ''
    END AS DATA_ALT
FROM SF1010 A
LEFT JOIN SYS_USR UCRI ON UCRI.D_E_L_E_T_ = '' AND UCRI.USR_ID = SUBSTRING(A.F1_USERLGI, 11,1)+SUBSTRING(A.F1_USERLGI, 15,1)+SUBSTRING(A.F1_USERLGI, 2, 1)+SUBSTRING(A.F1_USERLGI, 6, 1)+SUBSTRING(A.F1_USERLGI, 10,1)+SUBSTRING(A.F1_USERLGI, 14,1)+SUBSTRING(A.F1_USERLGI, 1, 1)+SUBSTRING(A.F1_USERLGI, 5, 1)+SUBSTRING(A.F1_USERLGI, 9, 1)+SUBSTRING(A.F1_USERLGI, 13,1)+SUBSTRING(A.F1_USERLGI, 17,1)+SUBSTRING(A.F1_USERLGI, 4, 1)
LEFT JOIN SYS_USR UALT ON UALT.D_E_L_E_T_ = '' AND UALT.USR_ID = SUBSTRING(A.F1_USERLGA, 11,1)+SUBSTRING(A.F1_USERLGA, 15,1)+SUBSTRING(A.F1_USERLGA, 2, 1)+SUBSTRING(A.F1_USERLGA, 6, 1)+SUBSTRING(A.F1_USERLGA, 10,1)+SUBSTRING(A.F1_USERLGA, 14,1)+SUBSTRING(A.F1_USERLGA, 1, 1)+SUBSTRING(A.F1_USERLGA, 5, 1)+SUBSTRING(A.F1_USERLGA, 9, 1)+SUBSTRING(A.F1_USERLGA, 13,1)+SUBSTRING(A.F1_USERLGA, 17,1)+SUBSTRING(A.F1_USERLGA, 4, 1) 
WHERE 1=1
AND A.D_E_L_E_T_ = ''
AND A.F1_FORNECE = '010469'


/* CONTAS A PAGAR */

SELECT 
A.E2_FILIAL,
A.E2_PREFIXO,
A.E2_NUM,
A.E2_VALOR,
A.E2_FORNECE,
A.E2_EMISSAO,
SUBSTRING(A.E2_USERLGI, 11,1)+
SUBSTRING(A.E2_USERLGI, 15,1)+
SUBSTRING(A.E2_USERLGI, 2, 1)+
SUBSTRING(A.E2_USERLGI, 6, 1)+
SUBSTRING(A.E2_USERLGI, 10,1)+
SUBSTRING(A.E2_USERLGI, 14,1)+
SUBSTRING(A.E2_USERLGI, 1, 1)+
SUBSTRING(A.E2_USERLGI, 5, 1)+
SUBSTRING(A.E2_USERLGI, 9, 1)+
SUBSTRING(A.E2_USERLGI, 13,1)+
SUBSTRING(A.E2_USERLGI, 17,1)+
SUBSTRING(A.E2_USERLGI, 4, 1) AS COD_Usuario_CRIACAO,
UCRI.USR_CODIGO AS USUARIO_CRI,
 CASE WHEN SUBSTRING(E2_USERLGI, 03, 1) != ' ' AND E2_USERLGI != '' THEN
        CONVERT(VARCHAR,DATEADD(DAY,CONVERT(INT,CONCAT(ASCII(SUBSTRING(E2_USERLGI,12,1)) - 50, ASCII(SUBSTRING(E2_USERLGI,16,1)) - 50) + IIF(SUBSTRING(E2_USERLGI,08,1) = '<',10000,0)),'1996-01-01'), 103)
    ELSE ''
    END AS DATA_INCL,
SUBSTRING(A.E2_USERLGA, 11,1)+
SUBSTRING(A.E2_USERLGA, 15,1)+
SUBSTRING(A.E2_USERLGA, 2, 1)+
SUBSTRING(A.E2_USERLGA, 6, 1)+
SUBSTRING(A.E2_USERLGA, 10,1)+
SUBSTRING(A.E2_USERLGA, 14,1)+
SUBSTRING(A.E2_USERLGA, 1, 1)+
SUBSTRING(A.E2_USERLGA, 5, 1)+
SUBSTRING(A.E2_USERLGA, 9, 1)+
SUBSTRING(A.E2_USERLGA, 13,1)+
SUBSTRING(A.E2_USERLGA, 17,1)+
SUBSTRING(A.E2_USERLGA, 4, 1) COD_Usuario_ALTERACAO,
UALT.USR_CODIGO AS USUARIO_ALT,
   CASE WHEN SUBSTRING(E2_USERLGA, 03, 1) != ' ' AND E2_USERLGA != '' THEN
        CONVERT(VARCHAR,DATEADD(DAY,CONVERT(INT,CONCAT(ASCII(SUBSTRING(E2_USERLGA,12,1)) - 50, ASCII(SUBSTRING(E2_USERLGA,16,1)) - 50) + IIF(SUBSTRING(E2_USERLGA,08,1) = '<',10000,0)),'1996-01-01'), 103)
    ELSE ''
    END AS DATA_ALT
FROM SE2010 A
LEFT JOIN SYS_USR UCRI ON UCRI.D_E_L_E_T_ = '' AND UCRI.USR_ID = SUBSTRING(A.E2_USERLGI, 11,1)+SUBSTRING(A.E2_USERLGI, 15,1)+SUBSTRING(A.E2_USERLGI, 2, 1)+SUBSTRING(A.E2_USERLGI, 6, 1)+SUBSTRING(A.E2_USERLGI, 10,1)+SUBSTRING(A.E2_USERLGI, 14,1)+SUBSTRING(A.E2_USERLGI, 1, 1)+SUBSTRING(A.E2_USERLGI, 5, 1)+SUBSTRING(A.E2_USERLGI, 9, 1)+SUBSTRING(A.E2_USERLGI, 13,1)+SUBSTRING(A.E2_USERLGI, 17,1)+SUBSTRING(A.E2_USERLGI, 4, 1)
LEFT JOIN SYS_USR UALT ON UALT.D_E_L_E_T_ = '' AND UALT.USR_ID = SUBSTRING(A.E2_USERLGA, 11,1)+SUBSTRING(A.E2_USERLGA, 15,1)+SUBSTRING(A.E2_USERLGA, 2, 1)+SUBSTRING(A.E2_USERLGA, 6, 1)+SUBSTRING(A.E2_USERLGA, 10,1)+SUBSTRING(A.E2_USERLGA, 14,1)+SUBSTRING(A.E2_USERLGA, 1, 1)+SUBSTRING(A.E2_USERLGA, 5, 1)+SUBSTRING(A.E2_USERLGA, 9, 1)+SUBSTRING(A.E2_USERLGA, 13,1)+SUBSTRING(A.E2_USERLGA, 17,1)+SUBSTRING(A.E2_USERLGA, 4, 1) 
WHERE 1=1
AND A.D_E_L_E_T_ = ''
AND A.E2_FORNECE = '010469'


/* LANCAMENTO CONTABIL */

SELECT 
A.*,
SUBSTRING(A.CT2_USERGI, 11,1)+
SUBSTRING(A.CT2_USERGI, 15,1)+
SUBSTRING(A.CT2_USERGI, 2, 1)+
SUBSTRING(A.CT2_USERGI, 6, 1)+
SUBSTRING(A.CT2_USERGI, 10,1)+
SUBSTRING(A.CT2_USERGI, 14,1)+
SUBSTRING(A.CT2_USERGI, 1, 1)+
SUBSTRING(A.CT2_USERGI, 5, 1)+
SUBSTRING(A.CT2_USERGI, 9, 1)+
SUBSTRING(A.CT2_USERGI, 13,1)+
SUBSTRING(A.CT2_USERGI, 17,1)+
SUBSTRING(A.CT2_USERGI, 4, 1) AS COD_Usuario_CRIACAO,
UCRI.USR_CODIGO AS USUARIO_CRI,
 CASE WHEN SUBSTRING(CT2_USERGI, 03, 1) != ' ' AND CT2_USERGI != '' THEN
        CONVERT(VARCHAR,DATEADD(DAY,CONVERT(INT,CONCAT(ASCII(SUBSTRING(CT2_USERGI,12,1)) - 50, ASCII(SUBSTRING(CT2_USERGI,16,1)) - 50) + IIF(SUBSTRING(CT2_USERGI,08,1) = '<',10000,0)),'1996-01-01'), 103)
    ELSE 
        ''
    END AS DATA_INCL,
SUBSTRING(A.CT2_USERGA, 11,1)+
SUBSTRING(A.CT2_USERGA, 15,1)+
SUBSTRING(A.CT2_USERGA, 2, 1)+
SUBSTRING(A.CT2_USERGA, 6, 1)+
SUBSTRING(A.CT2_USERGA, 10,1)+
SUBSTRING(A.CT2_USERGA, 14,1)+
SUBSTRING(A.CT2_USERGA, 1, 1)+
SUBSTRING(A.CT2_USERGA, 5, 1)+
SUBSTRING(A.CT2_USERGA, 9, 1)+
SUBSTRING(A.CT2_USERGA, 13,1)+
SUBSTRING(A.CT2_USERGA, 17,1)+
SUBSTRING(A.CT2_USERGA, 4, 1) COD_Usuario_ALTERACAO,
UALT.USR_CODIGO AS USUARIO_ALT,
   CASE WHEN SUBSTRING(CT2_USERGA, 03, 1) != ' ' AND CT2_USERGA != '' THEN
        CONVERT(VARCHAR,DATEADD(DAY,CONVERT(INT,CONCAT(ASCII(SUBSTRING(CT2_USERGA,12,1)) - 50, ASCII(SUBSTRING(CT2_USERGA,16,1)) - 50) + IIF(SUBSTRING(CT2_USERGA,08,1) = '<',10000,0)),'1996-01-01'), 103)
    ELSE ''
    END AS DATA_ALT
FROM CT2010 A
LEFT JOIN SYS_USR UCRI ON UCRI.D_E_L_E_T_ = '' AND UCRI.USR_ID = SUBSTRING(A.CT2_USERGI, 11,1)+SUBSTRING(A.CT2_USERGI, 15,1)+SUBSTRING(A.CT2_USERGI, 2, 1)+SUBSTRING(A.CT2_USERGI, 6, 1)+SUBSTRING(A.CT2_USERGI, 10,1)+SUBSTRING(A.CT2_USERGI, 14,1)+SUBSTRING(A.CT2_USERGI, 1, 1)+SUBSTRING(A.CT2_USERGI, 5, 1)+SUBSTRING(A.CT2_USERGI, 9, 1)+SUBSTRING(A.CT2_USERGI, 13,1)+SUBSTRING(A.CT2_USERGI, 17,1)+SUBSTRING(A.CT2_USERGI, 4, 1)
LEFT JOIN SYS_USR UALT ON UALT.D_E_L_E_T_ = '' AND UALT.USR_ID = SUBSTRING(A.CT2_USERGA, 11,1)+SUBSTRING(A.CT2_USERGA, 15,1)+SUBSTRING(A.CT2_USERGA, 2, 1)+SUBSTRING(A.CT2_USERGA, 6, 1)+SUBSTRING(A.CT2_USERGA, 10,1)+SUBSTRING(A.CT2_USERGA, 14,1)+SUBSTRING(A.CT2_USERGA, 1, 1)+SUBSTRING(A.CT2_USERGA, 5, 1)+SUBSTRING(A.CT2_USERGA, 9, 1)+SUBSTRING(A.CT2_USERGA, 13,1)+SUBSTRING(A.CT2_USERGA, 17,1)+SUBSTRING(A.CT2_USERGA, 4, 1) 
WHERE 1=1
AND A.CT2_VALOR = 16.60
AND A.CT2_FILIAL = '008001'



/* BA3 - GRUPO FAMILIA */

SELECT 
A.BA3_FILIAL    AS FILIAL,
A.BA3_MATEMP    AS MATEMP,
SA1.A1_COD      AS CODCLI,
SA1.A1_NOME     AS CLIENTE,
E.BT5_NOME      AS PERFIL,
SUBSTRING(A.BA3_USERGI, 11,1)+
SUBSTRING(A.BA3_USERGI, 15,1)+
SUBSTRING(A.BA3_USERGI, 2, 1)+
SUBSTRING(A.BA3_USERGI, 6, 1)+
SUBSTRING(A.BA3_USERGI, 10,1)+
SUBSTRING(A.BA3_USERGI, 14,1)+
SUBSTRING(A.BA3_USERGI, 1, 1)+
SUBSTRING(A.BA3_USERGI, 5, 1)+
SUBSTRING(A.BA3_USERGI, 9, 1)+
SUBSTRING(A.BA3_USERGI, 13,1)+
SUBSTRING(A.BA3_USERGI, 17,1)+
SUBSTRING(A.BA3_USERGI, 4, 1) AS COD_Usuario_CRIACAO,
UCRI.USR_CODIGO AS USUARIO_CRI
FROM BA3010 A
LEFT JOIN SYS_USR UCRI ON UCRI.D_E_L_E_T_ = '' AND UCRI.USR_ID = SUBSTRING(A.BA3_USERGI, 11,1)+SUBSTRING(A.BA3_USERGI, 15,1)+SUBSTRING(A.BA3_USERGI, 2, 1)+SUBSTRING(A.BA3_USERGI, 6, 1)+SUBSTRING(A.BA3_USERGI, 10,1)+SUBSTRING(A.BA3_USERGI, 14,1)+SUBSTRING(A.BA3_USERGI, 1, 1)+SUBSTRING(A.BA3_USERGI, 5, 1)+SUBSTRING(A.BA3_USERGI, 9, 1)+SUBSTRING(A.BA3_USERGI, 13,1)+SUBSTRING(A.BA3_USERGI, 17,1)+SUBSTRING(A.BA3_USERGI, 4, 1)
LEFT JOIN SA1010 SA1 ON SA1.A1_COD = A.BA3_CODCLI AND SA1.A1_LOJA = A.BA3_LOJA
LEFT JOIN BQC010 B ON A.BA3_CODINT = B.BQC_CODINT AND A.BA3_CODEMP = B.BQC_CODEMP AND A.BA3_CONEMP = B.BQC_NUMCON AND A.BA3_SUBCON = B.BQC_SUBCON AND A.D_E_L_E_T_ = ''   
LEFT JOIN BT5010 E ON E.D_E_L_E_T_ = '' AND E.BT5_FILIAL = B.BQC_FILIAL AND E.BT5_CODINT = B.BQC_CODINT AND E.BT5_CODIGO = B.BQC_CODEMP AND E.BT5_NUMCON = B.BQC_NUMCON AND E.BT5_VERSAO = B.BQC_VERCON
WHERE 1=1
AND UCRI.USR_ID = '000176'
AND SA1.A1_COD <> ''


/* BQC - GRUPO EMPRESA */

SELECT 
A.BQC_SUBCON,
A.BQC_CNPJ,
A.BQC_DESCRI,
E.BT5_NOME   AS PERFIL,
SUBSTRING(A.BQC_USERGI, 11,1)+
SUBSTRING(A.BQC_USERGI, 15,1)+
SUBSTRING(A.BQC_USERGI, 2, 1)+
SUBSTRING(A.BQC_USERGI, 6, 1)+
SUBSTRING(A.BQC_USERGI, 10,1)+
SUBSTRING(A.BQC_USERGI, 14,1)+
SUBSTRING(A.BQC_USERGI, 1, 1)+
SUBSTRING(A.BQC_USERGI, 5, 1)+
SUBSTRING(A.BQC_USERGI, 9, 1)+
SUBSTRING(A.BQC_USERGI, 13,1)+
SUBSTRING(A.BQC_USERGI, 17,1)+
SUBSTRING(A.BQC_USERGI, 4, 1) AS COD_Usuario_CRIACAO,
UCRI.USR_CODIGO AS USUARIO_CRI
FROM BQC010 A
LEFT JOIN SYS_USR UCRI ON UCRI.D_E_L_E_T_ = '' AND UCRI.USR_ID = SUBSTRING(A.BQC_USERGI, 11,1)+SUBSTRING(A.BQC_USERGI, 15,1)+SUBSTRING(A.BQC_USERGI, 2, 1)+SUBSTRING(A.BQC_USERGI, 6, 1)+SUBSTRING(A.BQC_USERGI, 10,1)+SUBSTRING(A.BQC_USERGI, 14,1)+SUBSTRING(A.BQC_USERGI, 1, 1)+SUBSTRING(A.BQC_USERGI, 5, 1)+SUBSTRING(A.BQC_USERGI, 9, 1)+SUBSTRING(A.BQC_USERGI, 13,1)+SUBSTRING(A.BQC_USERGI, 17,1)+SUBSTRING(A.BQC_USERGI, 4, 1)
LEFT JOIN BT5010 E ON E.D_E_L_E_T_ = '' AND E.BT5_FILIAL = A.BQC_FILIAL AND E.BT5_CODINT = A.BQC_CODINT AND E.BT5_CODIGO = A.BQC_CODEMP AND E.BT5_NUMCON = A.BQC_NUMCON AND E.BT5_VERSAO = A.BQC_VERCON
WHERE 1=1
AND UCRI.USR_ID = '000176'


/* SA1 - CLIENTES */

SELECT 
A.A1_COD       AS CODCLI,
A.A1_NOME      AS CLIENTE,
SUBSTRING(A.A1_USERLGI, 11,1)+
SUBSTRING(A.A1_USERLGI, 15,1)+
SUBSTRING(A.A1_USERLGI, 2, 1)+
SUBSTRING(A.A1_USERLGI, 6, 1)+
SUBSTRING(A.A1_USERLGI, 10,1)+
SUBSTRING(A.A1_USERLGI, 14,1)+
SUBSTRING(A.A1_USERLGI, 1, 1)+
SUBSTRING(A.A1_USERLGI, 5, 1)+
SUBSTRING(A.A1_USERLGI, 9, 1)+
SUBSTRING(A.A1_USERLGI, 13,1)+
SUBSTRING(A.A1_USERLGI, 17,1)+
SUBSTRING(A.A1_USERLGI, 4, 1) AS COD_Usuario_CRIACAO,
UCRI.USR_CODIGO AS USUARIO_CRI
FROM SA1010 A
LEFT JOIN SYS_USR UCRI ON UCRI.D_E_L_E_T_ = '' AND UCRI.USR_ID = SUBSTRING(A.A1_USERLGI, 11,1)+SUBSTRING(A.A1_USERLGI, 15,1)+SUBSTRING(A.A1_USERLGI, 2, 1)+SUBSTRING(A.A1_USERLGI, 6, 1)+SUBSTRING(A.A1_USERLGI, 10,1)+SUBSTRING(A.A1_USERLGI, 14,1)+SUBSTRING(A.A1_USERLGI, 1, 1)+SUBSTRING(A.A1_USERLGI, 5, 1)+SUBSTRING(A.A1_USERLGI, 9, 1)+SUBSTRING(A.A1_USERLGI, 13,1)+SUBSTRING(A.A1_USERLGI, 17,1)+SUBSTRING(A.A1_USERLGI, 4, 1)
WHERE 1=1
AND UCRI.USR_ID = '000176'

